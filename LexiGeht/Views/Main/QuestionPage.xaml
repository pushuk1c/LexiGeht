<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="LexiGeht.Views.Main.QuestionPage">


    <Grid RowDefinitions="*,Auto"
       BackgroundColor="WhiteSmoke">

        <Frame Grid.Row="0" HasShadow="True" CornerRadius="12" Margin="10,10,10,10">

            <Grid RowDefinitions="Auto,Auto,Auto,*,Auto">

                <Image Grid.Row="0" Source="{Binding CurrentQuestion.ImagePathSource}" 
                    Aspect="AspectFill"
                    VerticalOptions="Center" 
                    HorizontalOptions="Center"
                    MaximumHeightRequest="250"
                    MaximumWidthRequest="250"/>

                <!-- <Label Grid.Row="1" Text="{Binding CurrentQuestion.Title}"
                    VerticalOptions="Center" 
                    HorizontalOptions="Center" 
                    FontSize="26" 
                    FontFamily="RobotoRegular"
                    Margin="5,5"/> -->

                <Label Grid.Row="2" Text="{Binding CurrentQuestion.Description}"
                    LineBreakMode="WordWrap"
                    MaxLines="0"               
                    HorizontalOptions="FillAndExpand"
                    HorizontalTextAlignment="Center"
                    VerticalOptions="Start" 
                    FontSize="20" 
                    FontFamily="RobotoRegular"
                    Margin="10,5"/>

                <CollectionView Grid.Row="3" ItemsSource="{Binding Answers}" 
                    ItemsLayout="VerticalList" VerticalScrollBarVisibility="Never" Margin="10">

                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Button Grid.Row="4" Text="{Binding Title}" 
                                Margin="5,15"
                                TextColor="#5e17eb"
                                BorderWidth="2"
                                BorderColor="#5e17eb"
                                BackgroundColor="Transparent"
                                CornerRadius="30"
                                HorizontalOptions="Center"
                                VerticalOptions="End"
                                Padding="50,5"
                                FontSize="18"
                                FontFamily="RobotoRegular"
                                WidthRequest="300"
                                Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}},
                                              Path=BindingContext.ToggleAnswerCommand}"
                                CommandParameter="{Binding Id}">

                                <Button.Triggers>
                                    <DataTrigger TargetType="Button" Binding="{Binding State}" Value="Selected" >
                                        <Setter Property="BackgroundColor" Value="Blue"/>
                                        <Setter Property="TextColor" Value="White"/>
                                        <Setter Property="BorderColor" Value="Blue"/>
                                    </DataTrigger>
                                    <DataTrigger TargetType="Button" Binding="{Binding State}" Value="Correct" >
                                        <Setter Property="BackgroundColor" Value="Green"/>
                                        <Setter Property="TextColor" Value="White"/>
                                        <Setter Property="BorderColor" Value="Green"/>
                                    </DataTrigger>
                                    <DataTrigger TargetType="Button" Binding="{Binding State}" Value="InCorrect" >
                                        <Setter Property="BackgroundColor" Value="Red"/>
                                        <Setter Property="TextColor" Value="White"/>
                                        <Setter Property="BorderColor" Value="Red"/>
                                    </DataTrigger>
                                </Button.Triggers>
                            </Button>                            
                            
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

                <HorizontalStackLayout Grid.Row="4" Spacing="10" HorizontalOptions="Center">
                    <Button Grid.Row="4" Text="Submit" Command="{Binding SubmitAnswerCommand}" IsVisible="{Binding IsVisibleSubmit}"
                        TextColor="White"
                        BackgroundColor="#5e17eb"
                        CornerRadius="30"
                        HorizontalOptions="Center"
                        VerticalOptions="End"
                        FontSize="18"
                        FontFamily="RobotoRegular"
                        WidthRequest="150"/>

                    <Button Grid.Row="4" Text="Next" Command="{Binding NextCommand}" 
                        TextColor="White"
                        BackgroundColor="#5e17eb"
                        CornerRadius="30"
                        HorizontalOptions="Center"
                        VerticalOptions="End"
                        FontSize="18"
                        FontFamily="RobotoRegular"
                        WidthRequest="150"/>

                </HorizontalStackLayout>


            </Grid>

        </Frame>
    </Grid>


</ContentPage>